{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refs = {\n    formElem: document.querySelector('.form'),\n    inputElem: document.querySelector('.form-input'),\n    btnElem: document.querySelector('.form-button'),\n    galleryElem: document.querySelector('.gallery-list'),\n    btnLoadMoreElem: document.querySelector('.btn-load-more'),\n    loaderElem: document.querySelector('.loader'),\n};\n\n//===============================================================\n\nlet query = null;\nlet totalResult = 0;\nlet currentPage = 1;\nconst PAGE_SIZE = 15;\n\nasync function getImages(){\n    const url = 'https://pixabay.com/api/';\n    \n    const options = {\n        params: {\n            key : '42200986-2d8f017897691a4245488f945',\n            q: query,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safeSearch: true, \n            page: currentPage, \n            per_page: 15,\n        },\n    };\n    const res = await axios.get(url , options);\n    return res.data\n};\n//===============================================================\n\nrefs.formElem.addEventListener('submit', onBtnSubmit);\n\nasync function onBtnSubmit(e) {\ne.preventDefault();\n\nshowLoader();\nconst inputValue = e.target.elements.query.value.trim();\nif(!inputValue) return;\nquery = inputValue;\ncurrentPage = 1;\nrefs.galleryElem.innerHTML = '';\nconst data = await getImages();\ntotalResult = data.totalHits;\nconsole.log(data);\nrenderImages(data.hits);\n\nhideLoader();\ncheckBtnStatus();\nrefs.formElem.reset();\n}\n\n\nfunction imageTemplate ({\n    webformatURL, \n    largeImageURL, \n    tags, \n    likes, \n    views, \n    comments, \n    downloads}){\n    return ` <a href=\"${largeImageURL}\" class=\"gallery\">\n    <figure class=\"gallery-figure\"> \n     <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-img\"/>\n     <figcaption class=\"gallery-figcaption\">\n     <div class=\"img-item\">Likes <span class=\"img-elem\">${likes}</span></div>\n     <div class=\"img-item\">View <span class=\"img-elem\">${views}</span></div>\n     <div class=\"img-item\">Comments <span class=\"img-elem\">${comments}</span></div>\n     <div class=\"img-item\">Downloads <span class=\"img-elem\">${downloads}</span></div>\n     </figcaption>\n     </figure>\n     </a>`;\n}\n\n \nfunction renderImages(images){\n    const markup = images.map(imageTemplate).join('');\n    refs.galleryElem.insertAdjacentHTML('beforeend', markup);\n}\n\n\n//===============================================================\n\nrefs.btnLoadMoreElem.addEventListener('click', onBtnLoadMore);\n\nasync function onBtnLoadMore(){\n showLoader();\n currentPage += 1;\n const data = await getImages();\n renderImages(data.hits);\n hideLoader();\n checkBtnStatus();\n\n\n const galleryCardHeight = document.querySelector('.gallery-img').getBoundingClientRect().height;\n window.scrollBy({\n   top: 2 * galleryCardHeight,\n   behavior: 'smooth',  \n });\n}\n\n\nfunction checkBtnStatus () {\n    const maxPage = Math.ceil(totalResult/PAGE_SIZE);\n    const lastPage = maxPage <= currentPage;\n    if(lastPage){\n        refs.btnLoadMoreElem.classList.add('hidden');\n        iziToast.show({\n            message: `\"We're sorry, but you've reached the end of search results.\"`,\n            color: 'blue',\n        });\n    } else {\n        refs.btnLoadMoreElem.classList.remove('hidden');\n    }\n}\n\n\n//===============================================================\n\nfunction showLoader(){\n refs.loaderElem.classList.remove('hidden');\n refs.btnLoadMoreElem.classList.add('hidden');\n};\n\nfunction hideLoader(){\n refs.loaderElem.classList.add('hidden');\n refs.btnLoadMoreElem.classList.remove('hidden');\n};\n\n\n\n "],"names":["refs","query","totalResult","currentPage","PAGE_SIZE","getImages","url","options","axios","onBtnSubmit","e","showLoader","inputValue","data","renderImages","hideLoader","checkBtnStatus","imageTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","images","markup","onBtnLoadMore","galleryCardHeight","iziToast"],"mappings":"6vBAIA,MAAMA,EAAO,CACT,SAAU,SAAS,cAAc,OAAO,EACxC,UAAW,SAAS,cAAc,aAAa,EAC/C,QAAS,SAAS,cAAc,cAAc,EAC9C,YAAa,SAAS,cAAc,eAAe,EACnD,gBAAiB,SAAS,cAAc,gBAAgB,EACxD,WAAY,SAAS,cAAc,SAAS,CAChD,EAIA,IAAIC,EAAQ,KACRC,EAAc,EACdC,EAAc,EAClB,MAAMC,EAAY,GAElB,eAAeC,GAAW,CACtB,MAAMC,EAAM,2BAENC,EAAU,CACZ,OAAQ,CACJ,IAAM,qCACN,EAAGN,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAME,EACN,SAAU,EACb,CACT,EAEI,OADY,MAAMK,EAAM,IAAIF,EAAMC,CAAO,GAC9B,IACf,CAGAP,EAAK,SAAS,iBAAiB,SAAUS,CAAW,EAEpD,eAAeA,EAAYC,EAAG,CAC9BA,EAAE,eAAc,EAEhBC,IACA,MAAMC,EAAaF,EAAE,OAAO,SAAS,MAAM,MAAM,OACjD,GAAG,CAACE,EAAY,OAChBX,EAAQW,EACRT,EAAc,EACdH,EAAK,YAAY,UAAY,GAC7B,MAAMa,EAAO,MAAMR,IACnBH,EAAcW,EAAK,UACnB,QAAQ,IAAIA,CAAI,EAChBC,EAAaD,EAAK,IAAI,EAEtBE,IACAC,IACAhB,EAAK,SAAS,OACd,CAGA,SAASiB,EAAe,CACpB,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CAAS,EAAE,CACX,MAAO,aAAaL,CAAa;AAAA;AAAA,iBAEpBD,CAAY,UAAUE,CAAI;AAAA;AAAA,0DAEeC,CAAK;AAAA,yDACNC,CAAK;AAAA,6DACDC,CAAQ;AAAA,8DACPC,CAAS;AAAA;AAAA;AAAA,UAIvE,CAGA,SAASV,EAAaW,EAAO,CACzB,MAAMC,EAASD,EAAO,IAAIR,CAAa,EAAE,KAAK,EAAE,EAChDjB,EAAK,YAAY,mBAAmB,YAAa0B,CAAM,CAC3D,CAKA1B,EAAK,gBAAgB,iBAAiB,QAAS2B,CAAa,EAE5D,eAAeA,GAAe,CAC7BhB,IACAR,GAAe,EACf,MAAMU,EAAO,MAAMR,IACnBS,EAAaD,EAAK,IAAI,EACtBE,IACAC,IAGA,MAAMY,EAAoB,SAAS,cAAc,cAAc,EAAE,sBAAuB,EAAC,OACzF,OAAO,SAAS,CACd,IAAK,EAAIA,EACT,SAAU,QACb,CAAE,CACF,CAGA,SAASZ,GAAkB,CACP,KAAK,KAAKd,EAAYE,CAAS,GACnBD,GAExBH,EAAK,gBAAgB,UAAU,IAAI,QAAQ,EAC3C6B,EAAS,KAAK,CACV,QAAS,+DACT,MAAO,MACnB,CAAS,GAED7B,EAAK,gBAAgB,UAAU,OAAO,QAAQ,CAEtD,CAKA,SAASW,GAAY,CACpBX,EAAK,WAAW,UAAU,OAAO,QAAQ,EACzCA,EAAK,gBAAgB,UAAU,IAAI,QAAQ,CAC5C,CAEA,SAASe,GAAY,CACpBf,EAAK,WAAW,UAAU,IAAI,QAAQ,EACtCA,EAAK,gBAAgB,UAAU,OAAO,QAAQ,CAC/C"}